<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Week 4, Class 2: Network Analysis with R | Applying Network Analysis to Humanities</title>
  <meta name="description" content="Week 4, Class 2: Network Analysis with R | Applying Network Analysis to Humanities" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Week 4, Class 2: Network Analysis with R | Applying Network Analysis to Humanities" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="yann-ryan/network-analysis-humanities-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Week 4, Class 2: Network Analysis with R | Applying Network Analysis to Humanities" />
  
  
  

<meta name="author" content="Yann Ryan, Iiro Tihonen" />


<meta name="date" content="2022-09-29" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-4-class-1-network-metrics.html"/>
<link rel="next" href="week-5-class-1-visualising-networks-with-ggraph.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Network Analysis Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>About this Book</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#about-the-course"><i class="fa fa-check"></i>About the course</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html"><i class="fa fa-check"></i>Week 1, class 1: Course Introduction</a>
<ul>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#introduction"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#how-to-use-this-book-and-follow-the-course."><i class="fa fa-check"></i>How to use this book and follow the course.</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#what-do-we-mean-by-a-network"><i class="fa fa-check"></i>What do we mean by a ‘network’?</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#graph-theory"><i class="fa fa-check"></i>Graph Theory</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#why-use-networks-in-humanities"><i class="fa fa-check"></i>Why use networks in humanities?</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#network-basics"><i class="fa fa-check"></i>Network Basics</a>
<ul>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#nodes-and-edges"><i class="fa fa-check"></i>Nodes and Edges</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#edge-weights"><i class="fa fa-check"></i>Edge weights</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#edge-direction"><i class="fa fa-check"></i>Edge direction</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#weighted-and-directed"><i class="fa fa-check"></i>Weighted and directed</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#different-network-types"><i class="fa fa-check"></i>Different Network Types</a>
<ul>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#bipartite-networks"><i class="fa fa-check"></i>Bipartite networks</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#multigraphs"><i class="fa fa-check"></i>Multigraphs</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#hypergraphs"><i class="fa fa-check"></i>Hypergraphs</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#spatial-networks"><i class="fa fa-check"></i>Spatial networks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#from-bridges-to-social-networks"><i class="fa fa-check"></i>From Bridges to Social Networks…</a>
<ul>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#the-strength-of-weak-ties"><i class="fa fa-check"></i>The Strength of Weak Ties</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#its-a-small-world"><i class="fa fa-check"></i>It’s a Small World</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#the-new-science-of-networks"><i class="fa fa-check"></i>The ‘New’ Science of Networks</a></li>
<li class="chapter" data-level="" data-path="week-1-class-1-course-introduction.html"><a href="week-1-class-1-course-introduction.html#conclusion"><i class="fa fa-check"></i>Conclusion</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><i class="fa fa-check"></i>Week 1, Class 2: Introduction to R and the Tidyverse</a>
<ul>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#exercises"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#r-and-r-studio"><i class="fa fa-check"></i>R and R-Studio</a>
<ul>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#logging-into-csc-notebooks-and-opening-a-notebook."><i class="fa fa-check"></i>Logging into CSC notebooks and opening a notebook.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#using-r"><i class="fa fa-check"></i>Using R</a>
<ul>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#base-r."><i class="fa fa-check"></i>‘Base’ R.</a></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#basic-r-data-types."><i class="fa fa-check"></i>Basic R data types.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#tidyverse"><i class="fa fa-check"></i>Tidyverse</a>
<ul>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#select-pull"><i class="fa fa-check"></i>select(), pull()</a></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#group_by-tally-summarise"><i class="fa fa-check"></i>group_by(), tally(), summarise()</a></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#filter"><i class="fa fa-check"></i>filter()</a></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#sort-arrange"><i class="fa fa-check"></i>sort(), arrange()</a></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#left_join-inner_join-anti_join"><i class="fa fa-check"></i>left_join(), inner_join(), anti_join()</a></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#piping"><i class="fa fa-check"></i>Piping</a></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#plotting-using-ggplot"><i class="fa fa-check"></i>Plotting using ggplot()</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#reading-in-external-data"><i class="fa fa-check"></i>Reading in external data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-2-class-1-acquiring-and-working-with-network-data.html"><a href="week-2-class-1-acquiring-and-working-with-network-data.html"><i class="fa fa-check"></i>Week 2, Class 1: Acquiring and Working With Network Data</a></li>
<li class="chapter" data-level="" data-path="week-2-class-2-data-cleaning.html"><a href="week-2-class-2-data-cleaning.html"><i class="fa fa-check"></i>Week 2, Class 2: Data Cleaning</a></li>
<li class="chapter" data-level="" data-path="week-3-class-1-data-modelling.html"><a href="week-3-class-1-data-modelling.html"><i class="fa fa-check"></i>Week 3, Class 1: Data modelling</a></li>
<li class="chapter" data-level="" data-path="week-3-class-2-build-a-data-model-with-r.html"><a href="week-3-class-2-build-a-data-model-with-r.html"><i class="fa fa-check"></i>Week 3, Class 2: Build a Data Model with R</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html"><i class="fa fa-check"></i>Week 4, Class 1: Network Metrics</a>
<ul>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#exercises-1"><i class="fa fa-check"></i>Exercises</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#introduction-1"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#node-level-metrics"><i class="fa fa-check"></i>Node-level metrics</a>
<ul>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#degree"><i class="fa fa-check"></i>Degree</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#betweenness-centrality"><i class="fa fa-check"></i>Betweenness Centrality</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#eigenvector-centrality"><i class="fa fa-check"></i>Eigenvector Centrality</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#closeness-centrality"><i class="fa fa-check"></i>Closeness centrality</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#edge-level-metrics"><i class="fa fa-check"></i>Edge-level metrics</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#global-metrics"><i class="fa fa-check"></i>Global Metrics</a>
<ul>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#density"><i class="fa fa-check"></i>Density</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#average-path-length"><i class="fa fa-check"></i>Average path length</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#clustering-coefficient"><i class="fa fa-check"></i>Clustering coefficient</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#community-structure-in-networks"><i class="fa fa-check"></i>Community Structure in Networks</a></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#modularity"><i class="fa fa-check"></i>Modularity</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4-class-1-network-metrics.html"><a href="week-4-class-1-network-metrics.html#conclusions"><i class="fa fa-check"></i>Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html"><i class="fa fa-check"></i>Week 4, Class 2: Network Analysis with R</a>
<ul>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#introduction-2"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#creating-a-network-object-in-r"><i class="fa fa-check"></i>Creating a Network Object in R</a>
<ul>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#import-network-data"><i class="fa fa-check"></i>Import Network Data</a></li>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#turn-the-edge-list-into-a-tbl_graph"><i class="fa fa-check"></i>Turn the edge list into a tbl_graph</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#calculating-network-metrics"><i class="fa fa-check"></i>Calculating Network Metrics</a>
<ul>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#global-metrics-1"><i class="fa fa-check"></i>Global metrics</a></li>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#node-level-metrics."><i class="fa fa-check"></i>Node-level metrics.</a></li>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#summarising-the-network-data"><i class="fa fa-check"></i>Summarising the network data</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#joining-additional-data"><i class="fa fa-check"></i>Joining additional data</a></li>
<li class="chapter" data-level="" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#conclusions-1"><i class="fa fa-check"></i>Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html"><i class="fa fa-check"></i>Week 5, Class 1: Visualising Networks with ggraph</a>
<ul>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#network-visualisations"><i class="fa fa-check"></i>Network visualisations</a>
<ul>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#force-directed-network-visualisations"><i class="fa fa-check"></i>Force-directed network visualisations</a></li>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#other-network-visualisations"><i class="fa fa-check"></i>Other Network Visualisations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#network-visualisations-with-r-and-ggraph."><i class="fa fa-check"></i>Network Visualisations with R and ggraph.</a>
<ul>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#ggraph-and-other-tidyverse-functions"><i class="fa fa-check"></i>Ggraph and other tidyverse functions</a></li>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#add-node-labels"><i class="fa fa-check"></i>Add node labels</a></li>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#calculating-and-coloring-by-community-detection"><i class="fa fa-check"></i>Calculating and coloring by community detection</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#case-study-scientists-and-politicians"><i class="fa fa-check"></i>Case study: Scientists and Politicians</a></li>
<li class="chapter" data-level="" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#conclusions-2"><i class="fa fa-check"></i>Conclusions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html"><i class="fa fa-check"></i>Week 5, class 2: Other network types</a>
<ul>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#bipartite-networks-1"><i class="fa fa-check"></i>Bipartite networks</a></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#make-a-bipartite-network-in-r"><i class="fa fa-check"></i>Make a bipartite network in R</a>
<ul>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#create-a-regular-network-graph"><i class="fa fa-check"></i>Create a regular network graph</a></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#specify-the-type"><i class="fa fa-check"></i>Specify the type</a></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#visualise-as-bipartite"><i class="fa fa-check"></i>Visualise as bipartite</a></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#project-to-one-mode."><i class="fa fa-check"></i>Project to one-mode.</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#multi-layer-networks"><i class="fa fa-check"></i>Multi-layer networks</a>
<ul>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#visualise-with-ggraph-and-geom_edge_fan"><i class="fa fa-check"></i>Visualise with ggraph and geom_edge_fan()</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#spatial-networks-1"><i class="fa fa-check"></i>Spatial networks</a></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#temporal-networks"><i class="fa fa-check"></i>Temporal networks</a></li>
<li class="chapter" data-level="" data-path="week-5-class-2-other-network-types.html"><a href="week-5-class-2-other-network-types.html#case-study-bipartite-publisher-network"><i class="fa fa-check"></i>Case study: bipartite publisher network</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-6-class-1-asking-and-answering-questions-with-networks.html"><a href="week-6-class-1-asking-and-answering-questions-with-networks.html"><i class="fa fa-check"></i>Week 6, Class 1: Asking and Answering Questions with Networks</a>
<ul>
<li class="chapter" data-level="" data-path="week-6-class-1-asking-and-answering-questions-with-networks.html"><a href="week-6-class-1-asking-and-answering-questions-with-networks.html#what-makes-a-good-question-of-a-network"><i class="fa fa-check"></i>What makes a good question of a network?</a></li>
<li class="chapter" data-level="" data-path="week-6-class-1-asking-and-answering-questions-with-networks.html"><a href="week-6-class-1-asking-and-answering-questions-with-networks.html#using-the-data-model"><i class="fa fa-check"></i>Using the data model</a></li>
<li class="chapter" data-level="" data-path="week-6-class-1-asking-and-answering-questions-with-networks.html"><a href="week-6-class-1-asking-and-answering-questions-with-networks.html#using-visualisations"><i class="fa fa-check"></i>Using visualisations</a></li>
<li class="chapter" data-level="" data-path="week-6-class-1-asking-and-answering-questions-with-networks.html"><a href="week-6-class-1-asking-and-answering-questions-with-networks.html#network-statistics"><i class="fa fa-check"></i>Network statistics</a>
<ul>
<li class="chapter" data-level="" data-path="week-6-class-1-asking-and-answering-questions-with-networks.html"><a href="week-6-class-1-asking-and-answering-questions-with-networks.html#networks-and-regression"><i class="fa fa-check"></i>Networks and regression</a></li>
<li class="chapter" data-level="" data-path="week-6-class-1-asking-and-answering-questions-with-networks.html"><a href="week-6-class-1-asking-and-answering-questions-with-networks.html#ergms."><i class="fa fa-check"></i>ERGMs.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-6-class-2-putting-it-all-together.html"><a href="week-6-class-2-putting-it-all-together.html"><i class="fa fa-check"></i>Week 6, Class 2: Putting it all together</a>
<ul>
<li class="chapter" data-level="" data-path="week-6-class-2-putting-it-all-together.html"><a href="week-6-class-2-putting-it-all-together.html#course-project"><i class="fa fa-check"></i>Course Project</a></li>
<li class="chapter" data-level="" data-path="week-6-class-2-putting-it-all-together.html"><a href="week-6-class-2-putting-it-all-together.html#using-your-data-model"><i class="fa fa-check"></i>Using your data model</a></li>
<li class="chapter" data-level="" data-path="week-6-class-2-putting-it-all-together.html"><a href="week-6-class-2-putting-it-all-together.html#how-to-comment-on-a-network"><i class="fa fa-check"></i>How to comment on a network</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="week-7-reflections.html"><a href="week-7-reflections.html"><i class="fa fa-check"></i>Week 7: Reflections</a>
<ul>
<li class="chapter" data-level="" data-path="week-7-reflections.html"><a href="week-7-reflections.html#limitations-and-pitfalls"><i class="fa fa-check"></i>Limitations and pitfalls</a></li>
<li class="chapter" data-level="" data-path="week-7-reflections.html"><a href="week-7-reflections.html#biases-representation"><i class="fa fa-check"></i>Biases, representation</a></li>
<li class="chapter" data-level="" data-path="week-7-reflections.html"><a href="week-7-reflections.html#effects-of-missing-data"><i class="fa fa-check"></i>Effects of missing data</a></li>
<li class="chapter" data-level="" data-path="week-7-reflections.html"><a href="week-7-reflections.html#dangers-of-a-network-view-of-the-world."><i class="fa fa-check"></i>Dangers of a network view of the world.</a></li>
<li class="chapter" data-level="" data-path="week-7-reflections.html"><a href="week-7-reflections.html#networks-and-hegemonypower."><i class="fa fa-check"></i>Networks and hegemony/power.</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applying Network Analysis to Humanities</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-4-class-2-network-analysis-with-r" class="section level1 hasAnchor">
<h1>Week 4, Class 2: Network Analysis with R<a href="week-4-class-2-network-analysis-with-r.html#week-4-class-2-network-analysis-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-2" class="section level2 hasAnchor">
<h2>Introduction<a href="week-4-class-2-network-analysis-with-r.html#introduction-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this class, we’ll talk through creating and analysing a network object in R. The network we’ll work with is a sample of correspondence data taken from the British State Papers in the seventeenth century.</p>
</div>
<div id="creating-a-network-object-in-r" class="section level2 hasAnchor">
<h2>Creating a Network Object in R<a href="week-4-class-2-network-analysis-with-r.html#creating-a-network-object-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the easiest data formats to construct a network is an edge list: a simple dataframe with two columns, representing the connections between two nodes, one per row. It makes particular sense with correspondence data, which is often stored as records of letters with a ‘from’ and a ‘to’—more or less a ready-made edge list. In a correspondence dataset you might also have multiple sets of each of the edges (multiple letters between the same pair of individuals). This will be added to the edges as a ‘weight’.</p>
<p>We will use three R network libraries to do almost everything network-related, from analysis to visualisation: <code>igraph</code>, <code>tidygraph</code> and <code>ggraph</code>. The goal is to port everything to a format which is easy to work with using existing an established data analysis workflow. That format is known as ‘tidy data’, and it is a way of working with data which is easily transferable across a range of uses. It also means you need to learn very little new programming to do network analysis if you stay within this ‘ecosystem’.</p>
<div id="import-network-data" class="section level3 hasAnchor">
<h3>Import Network Data<a href="week-4-class-2-network-analysis-with-r.html#import-network-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The workflow uses a number of R packages. In the CSC Notebooks environment, these have already been installed and can be loaded using the commands below. If you are doing this on a local machine, you may have to install them first using the command <code>install.packages()</code>, with the package name specified as a string, for example <code>install.packages('igraph')</code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="week-4-class-2-network-analysis-with-r.html#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb55-2"><a href="week-4-class-2-network-analysis-with-r.html#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(igraph)</span>
<span id="cb55-3"><a href="week-4-class-2-network-analysis-with-r.html#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span></code></pre></div>
<p>In this class, we’ll use a dataset derived from the English State Papers. It takes the form of a .csv containing the information on the author, recipient, and date of sending for a small sample of state letters sent between 1670 and 1672.</p>
<p>Read the file into R with the <code>read_csv()</code> function from a previous lesson:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="week-4-class-2-network-analysis-with-r.html#cb56-1" aria-hidden="true" tabindex="-1"></a>letters <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;letter_data.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<p>The letters dataset is a simple dataframe. Each row represents a letter record, and has a unique ID. Essentially, each row is a record of who the author and recipient of the letter. Each of these senders and recipients also have both a unique ID, and the original name of the letter writer and sender. The unique ID is used because it’s quite likely that the names are not unique, and the network could combine two nodes with the same name together, for example.</p>
<p>This is used to construct an edge list. If you have multiple letters between individuals, you can count them and use as a weight in the network, or you can ignore it. This is done with <code>tidyverse</code> commands we learned previously: <code>group_by()</code> and <code>tally()</code>, changing the name of the new column to ‘weight’.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="week-4-class-2-network-analysis-with-r.html#cb57-1" aria-hidden="true" tabindex="-1"></a>edge_list <span class="ot">=</span> letters <span class="sc">%&gt;%</span> </span>
<span id="cb57-2"><a href="week-4-class-2-network-analysis-with-r.html#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(from_id, to_id) <span class="sc">%&gt;%</span> </span>
<span id="cb57-3"><a href="week-4-class-2-network-analysis-with-r.html#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>(<span class="at">name =</span> <span class="st">&#39;weight&#39;</span>)</span>
<span id="cb57-4"><a href="week-4-class-2-network-analysis-with-r.html#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="week-4-class-2-network-analysis-with-r.html#cb57-5" aria-hidden="true" tabindex="-1"></a>edge_list</span></code></pre></div>
<pre><code>## # A tibble: 364 × 3
## # Groups:   from_id [198]
##    from_id                 to_id                   weight
##    &lt;chr&gt;                   &lt;chr&gt;                    &lt;int&gt;
##  1 E000145-S012650-T000000 E022443-S042999-T000000      1
##  2 E000189-S014115-T000000 E004830-S019312-T000000      4
##  3 E000189-S014115-T000000 E006871-S022202-T000000      1
##  4 E000189-S014115-T000000 E022443-S042999-T000000      1
##  5 E000312-S012741-T000000 E022443-S042999-T000000      2
##  6 E000393-S036175-T000000 E001993-S018912-T000000      1
##  7 E000520-S001769-T000000 E003476-S051213-T000000      1
##  8 E000520-S001769-T000000 E022443-S042999-T000000      1
##  9 E000799-S042396-T000000 E022443-S042999-T000000      1
## 10 E001346-S047404-T000000 E022443-S042999-T000000      1
## # … with 354 more rows</code></pre>
<p>Now you see each unique combination of sender and recipient. If there are multiple letters, this is now signified by a weight of more than one in the weight column. You’ll also notice that the other information (letter IDs and actual names) has disappeared. This is not needed to make the network, but we can bring the name information back later.</p>
</div>
<div id="turn-the-edge-list-into-a-tbl_graph" class="section level3 hasAnchor">
<h3>Turn the edge list into a tbl_graph<a href="week-4-class-2-network-analysis-with-r.html#turn-the-edge-list-into-a-tbl_graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next transform the edge list into a network object called a tbl_graph, using <a href="https://www.data-imaginist.com/2017/introducing-tidygraph/">tidygraph</a>. A tbl_graph is a graph object which can be manipulated using tidyverse grammar. This means you can create a network and then use a range of standard data analysis functions on it as needed.</p>
<p>Use <code>as_tbl_graph()</code> to turn the edge list into a network. The first two columns will be taken as the from and to data, and any additional columns added as attributes. An important option is the <code>directed =</code> argument. This will specify whether the network is directed (the path goes from the first column to the second) or undirected. Because this network is inherently directed (a letter is sent from one person to another), we use <code>directed = TRUE</code>. In many cases, the network will be undirected, and this should be specified using <code>directed = FALSE</code>.</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="week-4-class-2-network-analysis-with-r.html#cb59-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="ot">=</span> edge_list <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="week-4-class-2-network-analysis-with-r.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>(<span class="at">directed =</span> T)</span>
<span id="cb59-3"><a href="week-4-class-2-network-analysis-with-r.html#cb59-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-4"><a href="week-4-class-2-network-analysis-with-r.html#cb59-4" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph</span></code></pre></div>
<pre><code>## # A tbl_graph: 248 nodes and 364 edges
## #
## # A directed simple graph with 6 components
## #
## # Node Data: 248 × 1 (active)
##   name                   
##   &lt;chr&gt;                  
## 1 E000145-S012650-T000000
## 2 E000189-S014115-T000000
## 3 E000312-S012741-T000000
## 4 E000393-S036175-T000000
## 5 E000520-S001769-T000000
## 6 E000799-S042396-T000000
## # … with 242 more rows
## #
## # Edge Data: 364 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1    89      1
## 2     2    22      4
## 3     2   199      1
## # … with 361 more rows</code></pre>
<p>The tbl_graph is an object containing two linked tables, one for the edges and one for the nodes. You can access each of the tables using the function <code>activate(nodes)</code> or <code>activate(edges)</code>. The active table is listed first and has the word ‘active’ in the description.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="week-4-class-2-network-analysis-with-r.html#cb61-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="week-4-class-2-network-analysis-with-r.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges)</span></code></pre></div>
<pre><code>## # A tbl_graph: 248 nodes and 364 edges
## #
## # A directed simple graph with 6 components
## #
## # Edge Data: 364 × 3 (active)
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1    89      1
## 2     2    22      4
## 3     2   199      1
## 4     2    89      1
## 5     3    89      2
## 6     4    10      1
## # … with 358 more rows
## #
## # Node Data: 248 × 1
##   name                   
##   &lt;chr&gt;                  
## 1 E000145-S012650-T000000
## 2 E000189-S014115-T000000
## 3 E000312-S012741-T000000
## # … with 245 more rows</code></pre>
<p>You can use many of the tidyverse commands we learned in the earlier lesson on this object, for example filtering to include only edges with a weight of more than 1:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="week-4-class-2-network-analysis-with-r.html#cb63-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb63-2"><a href="week-4-class-2-network-analysis-with-r.html#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">%&gt;%</span></span>
<span id="cb63-3"><a href="week-4-class-2-network-analysis-with-r.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(weight<span class="sc">&gt;</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tbl_graph: 248 nodes and 165 edges
## #
## # A directed simple graph with 121 components
## #
## # Edge Data: 165 × 3 (active)
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     2    22      4
## 2     3    89      2
## 3     9    74      2
## 4    10    89      6
## 5    12   154      2
## 6    13   202      2
## # … with 159 more rows
## #
## # Node Data: 248 × 1
##   name                   
##   &lt;chr&gt;                  
## 1 E000145-S012650-T000000
## 2 E000189-S014115-T000000
## 3 E000312-S012741-T000000
## # … with 245 more rows</code></pre>
</div>
</div>
<div id="calculating-network-metrics" class="section level2 hasAnchor">
<h2>Calculating Network Metrics<a href="week-4-class-2-network-analysis-with-r.html#calculating-network-metrics" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="global-metrics-1" class="section level3 hasAnchor">
<h3>Global metrics<a href="week-4-class-2-network-analysis-with-r.html#global-metrics-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first thing we want to do with this network is to calculate some global network statistics. Because the outputs to these are generally a single number, we don’t need to worry about storing them in a table, as we’ll do with the node-level metrics later. To calculate these metrics, generally just pass the network to a relevant function. These metrics were covered in more detail in the previous class.</p>
<div id="density-1" class="section level4 hasAnchor">
<h4>Density<a href="week-4-class-2-network-analysis-with-r.html#density-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>(the number of links present out of all possible links):</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="week-4-class-2-network-analysis-with-r.html#cb65-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> igraph<span class="sc">::</span><span class="fu">graph.density</span>()</span></code></pre></div>
<pre><code>## [1] 0.005942275</code></pre>
</div>
<div id="average-path-length-1" class="section level4 hasAnchor">
<h4>Average path length<a href="week-4-class-2-network-analysis-with-r.html#average-path-length-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>(the average number of hops between every pair of nodes in the network):</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="week-4-class-2-network-analysis-with-r.html#cb67-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> igraph<span class="sc">::</span><span class="fu">average.path.length</span>()</span></code></pre></div>
<pre><code>## [1] 11.04997</code></pre>
</div>
<div id="clustering-coefficient-1" class="section level4 hasAnchor">
<h4>Clustering coefficient:<a href="week-4-class-2-network-analysis-with-r.html#clustering-coefficient-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Because there are a number of ways to calculate clustering in a network, a method needs to be specified. The clustering coefficient is also known as <em>transitivity</em>, and it is defined as the ratio of completed triangles and connected triples in the graph. This measurement can be <em>global</em> (which counts the overall ratio) or <em>local</em> (which counts the individual ratio for each node). Because we want the global measurement, specific this with the <code>type =</code> argument.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="week-4-class-2-network-analysis-with-r.html#cb69-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> igraph<span class="sc">::</span><span class="fu">transitivity</span>(<span class="at">type =</span> <span class="st">&#39;global&#39;</span>)</span></code></pre></div>
<pre><code>## [1] 0.02453653</code></pre>
</div>
</div>
<div id="node-level-metrics." class="section level3 hasAnchor">
<h3>Node-level metrics.<a href="week-4-class-2-network-analysis-with-r.html#node-level-metrics." class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are a number of ways to calculate node-level metrics (these are things like degree, betweenness as explained in the previous class). For example, you can use igraph functions to calculate the degree of single node or group of nodes. The following code returns the degree for the node with the ID <code>E004654-S006979-T000000</code> (King Charles II of England). The argument <code>mode =</code> specifies the type of degree: in, out, or all, as we learned in the previous lesson.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="week-4-class-2-network-analysis-with-r.html#cb71-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> igraph<span class="sc">::</span><span class="fu">degree</span>(<span class="at">v =</span> <span class="st">&#39;E004654-S006979-T000000&#39;</span>, <span class="at">mode =</span> <span class="st">&#39;all&#39;</span>) </span></code></pre></div>
<pre><code>## E004654-S006979-T000000 
##                      52</code></pre>
<p>For most purposes, a table containing each of the nodes and the relevant metrics would be more useful (and something that can be analysed using R later). To do this, we use a function called <code>mutate()</code>. Mutate creates a new column containing the value from some calculation, which is performed on each row in the dataset.</p>
<p>Assign the name <code>degree</code> to the new column with <code>degree =</code>. The column should contain the total degree score for each node. This is done using the function <code>centrality_degree()</code>. With the two additional arguments in this function, specify the mode (in, out, or all) and, if a weighted degree score is desired, the column to be used as weights.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="week-4-class-2-network-analysis-with-r.html#cb73-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb73-2"><a href="week-4-class-2-network-analysis-with-r.html#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span> <span class="co"># make sure the nodes table is active</span></span>
<span id="cb73-3"><a href="week-4-class-2-network-analysis-with-r.html#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">&#39;all&#39;</span>, <span class="at">weights =</span> weight))</span></code></pre></div>
<pre><code>## # A tbl_graph: 248 nodes and 364 edges
## #
## # A directed simple graph with 6 components
## #
## # Node Data: 248 × 2 (active)
##   name                    degree
##   &lt;chr&gt;                    &lt;dbl&gt;
## 1 E000145-S012650-T000000      1
## 2 E000189-S014115-T000000     21
## 3 E000312-S012741-T000000      6
## 4 E000393-S036175-T000000      3
## 5 E000520-S001769-T000000      2
## 6 E000799-S042396-T000000      1
## # … with 242 more rows
## #
## # Edge Data: 364 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1    89      1
## 2     2    22      4
## 3     2   199      1
## # … with 361 more rows</code></pre>
<p>The data format allows you to use dplyr pipes <code>%&gt;%</code> to perform one calculation on the data, then pass that new dataframe along to the next function. Here we calculate the degree scores first, then filter to include only nodes with a degree score over two:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="week-4-class-2-network-analysis-with-r.html#cb75-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb75-2"><a href="week-4-class-2-network-analysis-with-r.html#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb75-3"><a href="week-4-class-2-network-analysis-with-r.html#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">&#39;total&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb75-4"><a href="week-4-class-2-network-analysis-with-r.html#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(degree <span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tbl_graph: 51 nodes and 124 edges
## #
## # A directed simple graph with 2 components
## #
## # Node Data: 51 × 2 (active)
##   name                    degree
##   &lt;chr&gt;                    &lt;dbl&gt;
## 1 E000189-S014115-T000000      8
## 2 E001993-S018912-T000000     37
## 3 E002622-S014197-T000000     10
## 4 E003476-S051213-T000000      6
## 5 E003494                      3
## 6 E004454-S051301-T000000      3
## # … with 45 more rows
## #
## # Edge Data: 124 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1     8      4
## 2     1    29      1
## 3     2     7      1
## # … with 121 more rows</code></pre>
</div>
<div id="summarising-the-network-data" class="section level3 hasAnchor">
<h3>Summarising the network data<a href="week-4-class-2-network-analysis-with-r.html#summarising-the-network-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To work with your new network metrics, the data can be outputted to a standard R dataframe. Create a new dataframe by doing this, using the tidyverse function for creating dataframes, <code>as_tibble()</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="week-4-class-2-network-analysis-with-r.html#cb77-1" aria-hidden="true" tabindex="-1"></a>network_metrics_df <span class="ot">=</span> sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb77-2"><a href="week-4-class-2-network-analysis-with-r.html#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span> <span class="co"># make sure correct table is active</span></span>
<span id="cb77-3"><a href="week-4-class-2-network-analysis-with-r.html#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(<span class="at">weights =</span> weight, <span class="at">mode =</span> <span class="st">&#39;all&#39;</span>)) <span class="sc">%&gt;%</span> <span class="co"># calculate degree</span></span>
<span id="cb77-4"><a href="week-4-class-2-network-analysis-with-r.html#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">between =</span> <span class="fu">centrality_betweenness</span>(<span class="at">weights =</span> weight,<span class="at">directed =</span> F)) <span class="sc">%&gt;%</span>  <span class="co"># calculate betweenness centrality</span></span>
<span id="cb77-5"><a href="week-4-class-2-network-analysis-with-r.html#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="co"># turn the nodes table into a plain dataframe</span></span></code></pre></div>
<pre><code>## Warning in betweenness(graph = graph, v = V(graph), directed = directed, :
## &#39;nobigint&#39; is deprecated since igraph 1.3 and will be removed in igraph 1.4</code></pre>
<p>This new table can be sorted, totals counted, and so forth:</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="week-4-class-2-network-analysis-with-r.html#cb79-1" aria-hidden="true" tabindex="-1"></a>network_metrics_df <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(degree))</span></code></pre></div>
<pre><code>## # A tibble: 248 × 3
##    name                    degree between
##    &lt;chr&gt;                    &lt;dbl&gt;   &lt;dbl&gt;
##  1 E004830-S019312-T000000    604   8048.
##  2 E022443-S042999-T000000    270  13404.
##  3 E600059-S012260-T000000    161   3223.
##  4 E013473                    150    235 
##  5 E004654-S006979-T000000     91  11774.
##  6 E001993-S018912-T000000     72   6663.
##  7 E903376-S024822-T000000     57   1623 
##  8 E008063                     51      0 
##  9 E002620-S051125-T000000     47      0 
## 10 E906453-S026312-T000000     47      0 
## # … with 238 more rows</code></pre>
</div>
</div>
<div id="joining-additional-data" class="section level2 hasAnchor">
<h2>Joining additional data<a href="week-4-class-2-network-analysis-with-r.html#joining-additional-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The value of working with a data model and tidygraph is that we can merge additional tables of data to our nodes or edges. In a separate table, we have a dataset of attributes about this set of nodes, including place and dates of birth and death, and gender. Using the <code>join()</code> commands, we can merge this table to the network data, and use it to sort, filter (and later visualise) the data:</p>
<p>First, load the table of data using <code>read_csv</code>:</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="week-4-class-2-network-analysis-with-r.html#cb81-1" aria-hidden="true" tabindex="-1"></a>node_attributes <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&#39;node_attributes.csv&#39;</span>)</span></code></pre></div>
<pre><code>## Rows: 248 Columns: 13
## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (11): name, main_name, all_names, links, gender, roles_titles, wikidata_...
## dbl  (2): birth_year, death_year
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="week-4-class-2-network-analysis-with-r.html#cb83-1" aria-hidden="true" tabindex="-1"></a>node_attributes</span></code></pre></div>
<pre><code>## # A tibble: 248 × 13
##    name     main_…¹ all_n…² links birth…³ death…⁴ gender roles…⁵ wikid…⁶ occup…⁷
##    &lt;chr&gt;    &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
##  1 E006019… Dr. Ra… Dr. Ra… http…    1617    1688 male   theolo… http:/… theolo…
##  2 E011771… Hyde, … Edward… http…    1609    1674 male   judge;… http:/… judge;…
##  3 E015103… Sir Ph… Sir Ph… http…    1607    1678 male   politi… http:/… politi…
##  4 E020134… Taylor… Silas … http…    1624    1678 male   compos… http:/… compos…
##  5 E014743… Sir Ed… Sir Ed… http…    1608    1654 male   econom… http:/… econom…
##  6 E020485… Sir Th… Sir Th… http…    1612    1685 male   naval … http:/… naval …
##  7 E004654… Charle… Charle… http…    1630    1685 male   sovere… http:/… sovere…
##  8 E007992… Heneag… Heneag… http…    1628    1689 male   diplom… http:/… diplom…
##  9 E007902… John F… John F… http…    1625    1686 male   priest  http:/… priest 
## 10 S035587  Philad… Philad… http…    1612    1665 female politi… http:/… politi…
## # … with 238 more rows, 3 more variables: place_of_birth &lt;chr&gt;,
## #   place_of_death &lt;chr&gt;, politician &lt;chr&gt;, and abbreviated variable names
## #   ¹​main_name, ²​all_names, ³​birth_year, ⁴​death_year, ⁵​roles_titles,
## #   ⁶​wikidata_item, ⁷​occupations</code></pre>
<p>This table contains further information about the nodes, each of which are identified by their unique ID. This can be joined to the network object using <code>join()</code> commands:</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="week-4-class-2-network-analysis-with-r.html#cb85-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb85-2"><a href="week-4-class-2-network-analysis-with-r.html#cb85-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_attributes, <span class="at">by =</span> <span class="st">&#39;name&#39;</span>)</span></code></pre></div>
<pre><code>## # A tbl_graph: 248 nodes and 364 edges
## #
## # A directed simple graph with 6 components
## #
## # Node Data: 248 × 13 (active)
##   name  main_n… all_na… links birth_… death_… gender roles_… wikida… occupa…
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
## 1 E000… Dr. La… Dr. La… http…    1632    1703 male   chapla… http:/… chapla…
## 2 E000… Edward… Edward… http…    1638    1697 male   astron… http:/… astron…
## 3 E000… Dr. Ri… Dr. Ri… http…    1619    1681 male   priest  http:/… priest 
## 4 E000… Solms-… Prince… http…    1602    1675 female art co… http:/… art co…
## 5 E000… Arthur… Arthur… http…    1614    1686 male   politi… http:/… politi…
## 6 E000… Sir Jo… Sir Jo… http…    1603    1671 male   politi… http:/… politi…
## # … with 242 more rows, and 3 more variables: place_of_birth &lt;chr&gt;,
## #   place_of_death &lt;chr&gt;, politician &lt;chr&gt;
## #
## # Edge Data: 364 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1    89      1
## 2     2    22      4
## 3     2   199      1
## # … with 361 more rows</code></pre>
<p>Using this approach you can now make subsets of the network, and calculate global or node-level statistics for these. This example would return a network containing only individuals with politician listed as one of their occupations, for example:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="week-4-class-2-network-analysis-with-r.html#cb87-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb87-2"><a href="week-4-class-2-network-analysis-with-r.html#cb87-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_attributes, <span class="at">by =</span> <span class="st">&#39;name&#39;</span>) <span class="sc">%&gt;%</span> <span class="co"># first join the attributes table again</span></span>
<span id="cb87-3"><a href="week-4-class-2-network-analysis-with-r.html#cb87-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(occupations, <span class="st">&quot;politician&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># returns any row with the string &#39;politician&#39; in it</span></span>
<span id="cb87-4"><a href="week-4-class-2-network-analysis-with-r.html#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(<span class="at">weights =</span> weight, <span class="at">mode =</span> <span class="st">&#39;all&#39;</span>)) <span class="co"># calculate network metrics on this new subset of the data.</span></span></code></pre></div>
<pre><code>## # A tbl_graph: 94 nodes and 106 edges
## #
## # A directed simple graph with 18 components
## #
## # Node Data: 94 × 14 (active)
##   name  main_n… all_na… links birth_… death_… gender roles_… wikida… occupa…
##   &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;  &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
## 1 E000… Arthur… Arthur… http…    1614    1686 male   politi… http:/… politi…
## 2 E000… Sir Jo… Sir Jo… http…    1603    1671 male   politi… http:/… politi…
## 3 E001… Henry … Henry … http…    1618    1685 male   politi… http:/… politi…
## 4 E002… Willia… Willia… http…    1649    1717 male   politi… http:/… politi…
## 5 E002… Edward… Edward… http…    1623    1683 male   politi… http:/… politi…
## 6 E002… Roger … Roger … http…    1621    1679 male   writer… http:/… writer…
## # … with 88 more rows, and 4 more variables: place_of_birth &lt;chr&gt;,
## #   place_of_death &lt;chr&gt;, politician &lt;chr&gt;, degree &lt;dbl&gt;
## #
## # Edge Data: 106 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1    33      1
## 2     2    33      1
## 3     3    10      1
## # … with 103 more rows</code></pre>
<details>
<br>
<summary>
Node attributes could be added and used to filter at several steps: before the network is created, and before or after network metrics are calculated. What differences might these make?
</summary>
<p>Make sure you know at which stage you are calculating network metrics. If you calculate them after filtering, you’ll get a set of metrics based on a new, subsetted network.</p>
</details>
<p><br></p>
<p>This new table can be outputted as a dataframe, as above. Here we use this to calculate the highest-degree nodes from the ‘polticians network’, keep their real names, and sort in descending order of degree:</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="week-4-class-2-network-analysis-with-r.html#cb89-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb89-2"><a href="week-4-class-2-network-analysis-with-r.html#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(node_attributes, <span class="at">by =</span> <span class="st">&#39;name&#39;</span>) <span class="sc">%&gt;%</span> <span class="co"># first join the attributes table again</span></span>
<span id="cb89-3"><a href="week-4-class-2-network-analysis-with-r.html#cb89-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(occupations, <span class="st">&quot;politician&quot;</span>)) <span class="sc">%&gt;%</span> <span class="co"># returns any row containing the string &#39;politician&#39;</span></span>
<span id="cb89-4"><a href="week-4-class-2-network-analysis-with-r.html#cb89-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(<span class="at">weights =</span> weight, <span class="at">mode =</span> <span class="st">&#39;all&#39;</span>))  <span class="sc">%&gt;%</span>   <span class="co"># calculate network metrics on this new subset of the data.</span></span>
<span id="cb89-5"><a href="week-4-class-2-network-analysis-with-r.html#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb89-6"><a href="week-4-class-2-network-analysis-with-r.html#cb89-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(degree)) <span class="sc">%&gt;%</span> <span class="fu">select</span>(name, main_name, degree)</span></code></pre></div>
<pre><code>## # A tibble: 94 × 3
##    name                    main_name                                      degree
##    &lt;chr&gt;                   &lt;chr&gt;                                           &lt;dbl&gt;
##  1 E022443-S042999-T000000 Williamson, Joseph (Sir)                          174
##  2 E001993-S018912-T000000 Henry Bennet, Earl of Arlington                    54
##  3 E004654-S006979-T000000 Charles II, King of England, Scotland, and Ir…     53
##  4 E002620-S051125-T000000 William Blathwaite                                 47
##  5 E002622-S014197-T000000 Edward Conway, Earl of Conway                      30
##  6 S016294                 Francis, Lord Aungier                              28
##  7 E903376-S024822-T000000 Witt, Johan de                                     28
##  8 S047442                 Thomas Belasyse, Earl of Fauconberg                26
##  9 E921955-S041743-T000000 Sir George Rawdon                                  25
## 10 E021031-S049939-T000000 Van Beuningen                                      21
## # … with 84 more rows</code></pre>
</div>
<div id="conclusions-1" class="section level2 hasAnchor">
<h2>Conclusions<a href="week-4-class-2-network-analysis-with-r.html#conclusions-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4-class-1-network-metrics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-5-class-1-visualising-networks-with-ggraph.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/4-2-networks-with-r_nb.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>

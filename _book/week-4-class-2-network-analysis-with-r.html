<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Week 4, Class 2: Network Analysis with R” | Applying Network Analysis to Humanities</title>
  <meta name="description" content="Chapter 9 Week 4, Class 2: Network Analysis with R” | Applying Network Analysis to Humanities" />
  <meta name="generator" content="bookdown 0.28 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Week 4, Class 2: Network Analysis with R” | Applying Network Analysis to Humanities" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="yann-ryan/network-analysis-humanities-book" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Week 4, Class 2: Network Analysis with R” | Applying Network Analysis to Humanities" />
  
  
  

<meta name="author" content="Yann Ryan, Iiro Tihonen" />


<meta name="date" content="2022-09-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="week-4-class-1-network-basics.html"/>
<link rel="next" href="week-5-class-1-visualising-networks-with-ggraph.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Network Analysis Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> About this Book</a></li>
<li class="chapter" data-level="2" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><i class="fa fa-check"></i><b>2</b> Week 1, class 1: Opening and Knitting an R Markdown File</a>
<ul>
<li class="chapter" data-level="2.1" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#introduction"><i class="fa fa-check"></i><b>2.1</b> Introduction</a></li>
<li class="chapter" data-level="2.2" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#what-is-r-markdown"><i class="fa fa-check"></i><b>2.2</b> What is R Markdown?</a></li>
<li class="chapter" data-level="2.3" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#the-rstudio-interface-for-r-markdown"><i class="fa fa-check"></i><b>2.3</b> The RStudio Interface for R Markdown</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#yaml-header"><i class="fa fa-check"></i><b>2.3.1</b> YAML Header</a></li>
<li class="chapter" data-level="2.3.2" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#code-chunks"><i class="fa fa-check"></i><b>2.3.2</b> Code Chunks</a></li>
<li class="chapter" data-level="2.3.3" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#text-editor"><i class="fa fa-check"></i><b>2.3.3</b> Text Editor</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#saving-and-knitting-a-copy"><i class="fa fa-check"></i><b>2.4</b> Saving and Knitting a copy</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#log-into-the-csc-notebooks-workspace"><i class="fa fa-check"></i><b>2.4.1</b> Log into the CSC notebooks workspace</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#rstudio"><i class="fa fa-check"></i><b>2.5</b> RStudio</a></li>
<li class="chapter" data-level="2.6" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#knit-the-file."><i class="fa fa-check"></i><b>2.6</b> Knit the file.</a></li>
<li class="chapter" data-level="2.7" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#download-and-send-it-to-the-course-leaders."><i class="fa fa-check"></i><b>2.7</b> Download and send it to the course leaders.</a></li>
<li class="chapter" data-level="2.8" data-path="week-1-class-1-opening-and-knitting-an-r-markdown-file.html"><a href="week-1-class-1-opening-and-knitting-an-r-markdown-file.html#more-resources"><i class="fa fa-check"></i><b>2.8</b> More resources</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><i class="fa fa-check"></i><b>3</b> Week 1, Class 2: Introduction to R and the Tidyverse</a>
<ul>
<li class="chapter" data-level="3.1" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#quick-introduction-to-r-and-the-tidyverse"><i class="fa fa-check"></i><b>3.1</b> Quick introduction to R and the tidyverse</a></li>
<li class="chapter" data-level="3.2" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#what-and-why"><i class="fa fa-check"></i><b>3.2</b> What and why?</a></li>
<li class="chapter" data-level="3.3" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#using-r"><i class="fa fa-check"></i><b>3.3</b> Using R</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#basic-r-data-types."><i class="fa fa-check"></i><b>3.3.1</b> Basic R data types.</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#tidyverse"><i class="fa fa-check"></i><b>3.4</b> Tidyverse</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#select-pull"><i class="fa fa-check"></i><b>3.4.1</b> select(), pull()</a></li>
<li class="chapter" data-level="3.4.2" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#group_by-tally-summarise"><i class="fa fa-check"></i><b>3.4.2</b> group_by(), tally(), summarise()</a></li>
<li class="chapter" data-level="3.4.3" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#filter"><i class="fa fa-check"></i><b>3.4.3</b> filter()</a></li>
<li class="chapter" data-level="3.4.4" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#sort-arrange-top_n"><i class="fa fa-check"></i><b>3.4.4</b> sort(), arrange(), top_n()</a></li>
<li class="chapter" data-level="3.4.5" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#left_join-inner_join-anti_join"><i class="fa fa-check"></i><b>3.4.5</b> left_join(), inner_join(), anti_join()</a></li>
<li class="chapter" data-level="3.4.6" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#piping"><i class="fa fa-check"></i><b>3.4.6</b> Piping</a></li>
<li class="chapter" data-level="3.4.7" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#plotting-using-ggplot"><i class="fa fa-check"></i><b>3.4.7</b> Plotting using ggplot()</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="week-1-class-2-introduction-to-r-and-the-tidyverse.html"><a href="week-1-class-2-introduction-to-r-and-the-tidyverse.html#exercise-for-this-week"><i class="fa fa-check"></i><b>3.5</b> Exercise for this week</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="week-2-class-1-acquiring-and-working-with-network-data.html"><a href="week-2-class-1-acquiring-and-working-with-network-data.html"><i class="fa fa-check"></i><b>4</b> Week 2, Class 1: Acquiring and Working With Network Data</a></li>
<li class="chapter" data-level="5" data-path="week-2-class-2-data-cleaning.html"><a href="week-2-class-2-data-cleaning.html"><i class="fa fa-check"></i><b>5</b> Week 2, Class 2: Data Cleaning</a></li>
<li class="chapter" data-level="6" data-path="week-3-class-1-data-modelling.html"><a href="week-3-class-1-data-modelling.html"><i class="fa fa-check"></i><b>6</b> Week 3, Class 1: Data modelling</a></li>
<li class="chapter" data-level="7" data-path="week-3-class-2-build-a-data-model-with-r.html"><a href="week-3-class-2-build-a-data-model-with-r.html"><i class="fa fa-check"></i><b>7</b> Week 3, Class 2: Build a Data Model with R</a></li>
<li class="chapter" data-level="8" data-path="week-4-class-1-network-basics.html"><a href="week-4-class-1-network-basics.html"><i class="fa fa-check"></i><b>8</b> Week 4, Class 1: Network Basics</a></li>
<li class="chapter" data-level="9" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html"><i class="fa fa-check"></i><b>9</b> Week 4, Class 2: Network Analysis with R”</a>
<ul>
<li class="chapter" data-level="9.1" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#introduction-1"><i class="fa fa-check"></i><b>9.1</b> Introduction</a></li>
<li class="chapter" data-level="9.2" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#constructing-a-network-in-r"><i class="fa fa-check"></i><b>9.2</b> Constructing a Network in R</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#import-network-data-with-the-tidyverse"><i class="fa fa-check"></i><b>9.2.1</b> Import Network Data with the Tidyverse</a></li>
<li class="chapter" data-level="9.2.2" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#turn-the-edge-list-into-a-tbl_graph"><i class="fa fa-check"></i><b>9.2.2</b> Turn the edge list into a tbl_graph</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="week-4-class-2-network-analysis-with-r.html"><a href="week-4-class-2-network-analysis-with-r.html#exercises"><i class="fa fa-check"></i><b>9.3</b> Exercises:</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html"><i class="fa fa-check"></i><b>10</b> Week 5, Class 1: Visualising Networks with ggraph</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#visualisation-with-ggraph"><i class="fa fa-check"></i><b>10.0.1</b> Visualisation with ggraph</a></li>
<li class="chapter" data-level="10.1" data-path="week-5-class-1-visualising-networks-with-ggraph.html"><a href="week-5-class-1-visualising-networks-with-ggraph.html#visualising-further-information-using-extra-information-with-joins"><i class="fa fa-check"></i><b>10.1</b> Visualising further information (using extra information with joins)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="week-5-class-2-visualising-with-gephi.html"><a href="week-5-class-2-visualising-with-gephi.html"><i class="fa fa-check"></i><b>11</b> Week 5, class 2: Visualising with Gephi</a></li>
<li class="chapter" data-level="12" data-path="week-6-class-1-bipartite-networks.html"><a href="week-6-class-1-bipartite-networks.html"><i class="fa fa-check"></i><b>12</b> Week 6, Class 1: Bipartite Networks</a></li>
<li class="chapter" data-level="13" data-path="week-6-class-2-literary-and-linguistic-networks.html"><a href="week-6-class-2-literary-and-linguistic-networks.html"><i class="fa fa-check"></i><b>13</b> Week 6, Class 2: Literary and Linguistic Networks</a></li>
<li class="chapter" data-level="14" data-path="week-7-reflections.html"><a href="week-7-reflections.html"><i class="fa fa-check"></i><b>14</b> Week 7: Reflections</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Applying Network Analysis to Humanities</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="week-4-class-2-network-analysis-with-r" class="section level1 hasAnchor" number="9">
<h1><span class="header-section-number">Chapter 9</span> Week 4, Class 2: Network Analysis with R”<a href="week-4-class-2-network-analysis-with-r.html#week-4-class-2-network-analysis-with-r" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="introduction-1" class="section level2 hasAnchor" number="9.1">
<h2><span class="header-section-number">9.1</span> Introduction<a href="week-4-class-2-network-analysis-with-r.html#introduction-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>A good place to start to learn R is the free book <a href="https://r4ds.had.co.nz/index.html" class="uri">https://r4ds.had.co.nz/index.html</a>, and if you want to learn how to use R for text mining specifically, <a href="https://www.tidytextmining.com/" class="uri">https://www.tidytextmining.com/</a> is an excellent (also free) online book.</p>
<p>This document you’re reading is called an R Notebook: it’s a special document which contains text <em>and</em> code. Anything within the gray block below is called a ‘chunk’. On the right-hand side you’ll see a little green triangle. Clicking that will run all the code in the chunk. 1 + 1 is very simple computer code which adds those two numbers together. Try clicking on the code.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="week-4-class-2-network-analysis-with-r.html#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">+</span><span class="dv">1</span></span></code></pre></div>
<pre><code>## [1] 2</code></pre>
<p>R runs the code, and displays the output underneath the chunk. This MyBinder R environment has loaded an individual ‘container’ for you to try out the code. Feel free to edit or add new code: no changes will be saved once we finish the session.</p>
</div>
<div id="constructing-a-network-in-r" class="section level2 hasAnchor" number="9.2">
<h2><span class="header-section-number">9.2</span> Constructing a Network in R<a href="week-4-class-2-network-analysis-with-r.html#constructing-a-network-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>One of the easiest data formats to construct a network is an edge list: a simple dataframe with two columns, representing the connections between two nodes, one per row. It makes particular sense with correspondence data, which is often stored as a table of letters with a ‘from’ and a ‘to’—more or less a ready-made edge list. In a correspondence dataset you might also have multiple sets of each of the edges (multiple letters between the same pair of individuals). You can add this to the edge list as an attribute called weight, which is simply another column.</p>
<p>I use three R network libraries to do almost everything network-related, from analysis to visualisation: <code>igraph</code>, <code>tidygraph</code> and <code>ggraph</code>. My goal is to port everything to a format which is really easy to work with using existing my data analysis workflow. That format is known as ‘tidy data’, and it is a way of working with data which is easily transferable across a range of uses. It also means you need to learn very little new programming to do network analysis if you stay within this ‘ecosystem’.</p>
<div id="import-network-data-with-the-tidyverse" class="section level3 hasAnchor" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Import Network Data with the Tidyverse<a href="week-4-class-2-network-analysis-with-r.html#import-network-data-with-the-tidyverse" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The whole workflow uses four packages. The first is <code>tidyverse</code>, a collection of various packages used for data wrangling and analytics.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="week-4-class-2-network-analysis-with-r.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb48-2"><a href="week-4-class-2-network-analysis-with-r.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb48-3"><a href="week-4-class-2-network-analysis-with-r.html#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb48-4"><a href="week-4-class-2-network-analysis-with-r.html#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span></code></pre></div>
<p>Next I need some network data. On the project this is generally a comma separated values file containing the information for one letter per row. We turn the raw letter data into an edge list in a standardised format, with the from/to information, a letter date, a place, and a unique identifier for the letter. Because the dataset is large and the same names are often used repeatedly, we use a unique ID number rather than people or place names when constructing the edge list. The nice thing about working within the tidyverse is that it’s easy to then match the IDs back to actual names afterwards.</p>
<p>These edge lists can be turned into a network object using <code>tidygraph</code> and the function <code>as_tbl_graph</code>. This function takes the first two columns in a dataset and turns them into the network graph, using any additional columns as attributes. We use two separate tables of data. First, an edge list, using unique, unambiguous numeric IDs for people and place names. Next, additional lookup tables, just with the unique ID, the person’s name, and additional information, if you have it (which can be used to filter the network afterwards).</p>
<p>First load the two tables into R (I’ve created small sample tables to work with), which are available <a href="https://raw.githubusercontent.com/networkingarchives/blog/master/2021/04/15/my-network-analysis-workflow/letters.csv">here</a> and <a href="https://raw.githubusercontent.com/networkingarchives/blog/master/2021/04/15/my-network-analysis-workflow/letters.csv">here</a>:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="week-4-class-2-network-analysis-with-r.html#cb49-1" aria-hidden="true" tabindex="-1"></a>letters <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/yann-ryan/dh_intro_gates/main/sample_letter_data_network.csv&quot;</span>, <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">.default =</span> <span class="st">&quot;c&quot;</span>))</span></code></pre></div>
<p>If you have multiple letters between individuals, you can sum them and use as a weight in the network, or you can ignore it. You can do this with <code>tidyverse</code> commands: <code>group_by()</code> and <code>tally()</code>, changing the name of the new column to ‘weight’.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="week-4-class-2-network-analysis-with-r.html#cb50-1" aria-hidden="true" tabindex="-1"></a>edge_list <span class="ot">=</span> letters <span class="sc">%&gt;%</span> </span>
<span id="cb50-2"><a href="week-4-class-2-network-analysis-with-r.html#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(author, recipient) <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="week-4-class-2-network-analysis-with-r.html#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tally</span>(<span class="at">name =</span> <span class="st">&#39;weight&#39;</span>)</span></code></pre></div>
</div>
<div id="turn-the-edge-list-into-a-tbl_graph" class="section level3 hasAnchor" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Turn the edge list into a tbl_graph<a href="week-4-class-2-network-analysis-with-r.html#turn-the-edge-list-into-a-tbl_graph" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next transform the edge list into a network object called a tbl_graph, using <a href="https://www.data-imaginist.com/2017/introducing-tidygraph/">tidygraph</a>. A tbl_graph is a graph object which can be manipulated using tidyverse grammar. This means you can create a network and then use a range of standard data analysis functions on it as needed, without learning a whole new set of commands.</p>
<p>First, load the tidygraph library. Use <code>as_tbl_graph()</code> to turn the edge list into a network. The first two columns will be taken as the from and to data, and any additional columns added as attributes. It’ll automatically create a nodes table, too.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="week-4-class-2-network-analysis-with-r.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidygraph)</span>
<span id="cb51-2"><a href="week-4-class-2-network-analysis-with-r.html#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="week-4-class-2-network-analysis-with-r.html#cb51-3" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="ot">=</span> edge_list <span class="sc">%&gt;%</span> </span>
<span id="cb51-4"><a href="week-4-class-2-network-analysis-with-r.html#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>()</span>
<span id="cb51-5"><a href="week-4-class-2-network-analysis-with-r.html#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="week-4-class-2-network-analysis-with-r.html#cb51-6" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph</span></code></pre></div>
<pre><code>## # A tbl_graph: 417 nodes and 479 edges
## #
## # A directed acyclic simple graph with 1 component
## #
## # Node Data: 417 × 1 (active)
##   name             
##   &lt;chr&gt;            
## 1 Agnes Austin     
## 2 Alice Thurrgood  
## 3 Amye Champernowne
## 4 Ane Carnsew      
## 5 Arthur Remys     
## 6 Arthur Strode    
## # … with 411 more rows
## #
## # Edge Data: 479 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1   124      1
## 2     2   117      1
## 3     3   100      1
## # … with 476 more rows</code></pre>
<p>The tbl_graph is an object with two tables, one for the edges and one for the nodes. You can access each of the tables using the function activate(nodes) or activate(edges). The active table has (active) after it.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="week-4-class-2-network-analysis-with-r.html#cb53-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="ot">=</span> sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb53-2"><a href="week-4-class-2-network-analysis-with-r.html#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges)</span>
<span id="cb53-3"><a href="week-4-class-2-network-analysis-with-r.html#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="week-4-class-2-network-analysis-with-r.html#cb53-4" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph</span></code></pre></div>
<pre><code>## # A tbl_graph: 417 nodes and 479 edges
## #
## # A directed acyclic simple graph with 1 component
## #
## # Edge Data: 479 × 3 (active)
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1   124      1
## 2     2   117      1
## 3     3   100      1
## 4     4    81      1
## 5     5   125      1
## 6     5   113      1
## # … with 473 more rows
## #
## # Node Data: 417 × 1
##   name             
##   &lt;chr&gt;            
## 1 Agnes Austin     
## 2 Alice Thurrgood  
## 3 Amye Champernowne
## # … with 414 more rows</code></pre>
<p>Tidygraph allows you to perform calculations on the tbl_graph using <code>mutate</code>, using standard igraph algorithms. So for example to calculate the degree of every node:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="week-4-class-2-network-analysis-with-r.html#cb55-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb55-2"><a href="week-4-class-2-network-analysis-with-r.html#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="week-4-class-2-network-analysis-with-r.html#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">&#39;total&#39;</span>))</span></code></pre></div>
<pre><code>## # A tbl_graph: 417 nodes and 479 edges
## #
## # A directed acyclic simple graph with 1 component
## #
## # Node Data: 417 × 2 (active)
##   name              degree
##   &lt;chr&gt;              &lt;dbl&gt;
## 1 Agnes Austin           2
## 2 Alice Thurrgood        1
## 3 Amye Champernowne      1
## 4 Ane Carnsew            1
## 5 Arthur Remys           3
## 6 Arthur Strode          2
## # … with 411 more rows
## #
## # Edge Data: 479 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1   124      1
## 2     2   117      1
## 3     3   100      1
## # … with 476 more rows</code></pre>
<p>If you run standard functions meant to be used on a dataframe, they will happen to the active table. So if you wanted to filter just edges from ID 1, for example, you could use the <code>filter</code> verb from dplyr:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="week-4-class-2-network-analysis-with-r.html#cb57-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> <span class="fu">filter</span>(from <span class="sc">==</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tbl_graph: 417 nodes and 1 edges
## #
## # A rooted forest with 416 trees
## #
## # Edge Data: 1 × 3 (active)
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1   124      1
## #
## # Node Data: 417 × 1
##   name             
##   &lt;chr&gt;            
## 1 Agnes Austin     
## 2 Alice Thurrgood  
## 3 Amye Champernowne
## # … with 414 more rows</code></pre>
<p>Maybe you only want to keep nodes with the title ‘Sir’? Activate the nodes again with <code>activate(nodes)</code>, join the people table, then use <code>filter</code> and <code>str_detect</code> to filter based on a regular expressions pattern. You’ll see that it has filtered out unused edges now, too:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="week-4-class-2-network-analysis-with-r.html#cb59-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb59-2"><a href="week-4-class-2-network-analysis-with-r.html#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes)<span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="week-4-class-2-network-analysis-with-r.html#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">str_detect</span>(name, <span class="st">&quot;(?i)sir&quot;</span>))</span></code></pre></div>
<pre><code>## # A tbl_graph: 14 nodes and 4 edges
## #
## # A rooted forest with 10 trees
## #
## # Node Data: 14 × 1 (active)
##   name                     
##   &lt;chr&gt;                    
## 1 Sir Faithful Fortescue   
## 2 Sir Phelim O&amp;#x0027;Neill
## 3 Sir Richard              
## 4 Sir Richard Carnsew      
## 5 Sir Lucas Dillon         
## 6 Sir Luke Fitzgerald      
## # … with 8 more rows
## #
## # Edge Data: 4 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1    10      1
## 2     1    11      1
## 3     3     9      1
## # … with 1 more row</code></pre>
<p>Slightly more useful might be to filter based on some calculation you’ve made previously. The data format allows you to use dplyr pipes (%&gt;%) to perform one calculation on the data, then pass that new dataframe along to the next function. It works really well with tidygraph. Here we calculate the degree scores first, then filter to include only nodes with a degree score over two:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="week-4-class-2-network-analysis-with-r.html#cb61-1" aria-hidden="true" tabindex="-1"></a>sample_tbl_graph <span class="sc">%&gt;%</span> </span>
<span id="cb61-2"><a href="week-4-class-2-network-analysis-with-r.html#cb61-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">%&gt;%</span> </span>
<span id="cb61-3"><a href="week-4-class-2-network-analysis-with-r.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree =</span> <span class="fu">centrality_degree</span>(<span class="at">mode =</span> <span class="st">&#39;total&#39;</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb61-4"><a href="week-4-class-2-network-analysis-with-r.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(degree <span class="sc">&gt;</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## # A tbl_graph: 48 nodes and 76 edges
## #
## # A directed acyclic simple graph with 5 components
## #
## # Node Data: 48 × 2 (active)
##   name                                                              degree
##   &lt;chr&gt;                                                              &lt;dbl&gt;
## 1 Arthur Remys                                                           3
## 2 Capt. Nicholas Burton                                                  3
## 3 Captain Brandon Cusacke                                                4
## 4 Christopher Creed                                                      3
## 5 Commissioners of the Supreme Council of the Confederate Catholics     10
## 6 Committee for Public Revenue                                           3
## # … with 42 more rows
## #
## # Edge Data: 76 × 3
##    from    to weight
##   &lt;int&gt; &lt;int&gt;  &lt;int&gt;
## 1     1    36      1
## 2     1    37      1
## 3     2    33      1
## # … with 73 more rows</code></pre>
</div>
</div>
<div id="exercises" class="section level2 hasAnchor" number="9.3">
<h2><span class="header-section-number">9.3</span> Exercises:<a href="week-4-class-2-network-analysis-with-r.html#exercises" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Load in the network you created the previous week.</p>
<p>Create a code chunk below to find the node with the highest degree in your network</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="week-4-class-1-network-basics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="week-5-class-1-visualising-networks-with-ggraph.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/4-2-networks-with-r_nb.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
